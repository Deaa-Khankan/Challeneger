<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>IP Analyzer</title>
        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    </head>
    
 <!-- Form -->
 <form method="post" class="mb-4 d-flex justify-content-center">
    <input type="text" name="ip" class="form-control w-50 me-2" placeholder="Enter IP address" required>
    <button type="submit" class="btn btn-primary">Check</button>
</form>


{% if ip %}
  <div class="alert alert-primary text-center">
    <strong>Analyzing IP:</strong> {{ ip }}
  </div>
{% endif %}




<!-- Report Cards -->
{% if report %}
<div class="row g-4">

    <!-- AbuseIPDB Card -->
    <div class="col-md-6">
        <div class="card shadow-sm h-100 ">
            <div class="card-header  bg-warning text-dark fw-bold d-">
                AbuseIPDB
            </div>
            <div class="card-body">
                <p>
                    <strong>Abuse Score:</strong>
                    <span class="{{ abuse_color(report.abuse.abuse_score) }}">
                      {{ report.abuse.abuse_score }}
                    </span>
                  </p>
                <p><strong>Total Reports:</strong> {{ report.abuse.total_reports }}</p>
                <p><strong>Country:</strong> {{ report.abuse.country }}</p>
                <p><strong>ISP:</strong> {{ report.abuse.isp }}</p>
                <p><strong>Domain:</strong> {{ report.abuse.domain }}</p>
                <p><strong>Usage Type:</strong> {{ report.abuse.usage_type }}</p>
            </div>
        </div>
    </div>

    <!-- VirusTotal Card -->
    <div class="col-md-6">
        <div class="card shadow-sm">
            <div class="card-header  bg-warning  text-dark fw-bold d-">
                VirusTotal
            </div>
            <div class="card-body">
                <p><strong>Reputation:</strong> {{ report.vt.reputation }}</p>
                <p>
                    <strong>Malicious:</strong>
                    <span class="{{ vt_color(report.vt.last_analysis_stats.malicious) }}">
                      {{ report.vt.last_analysis_stats.malicious }}
                    </span>
                  </p>

                <p><strong>Suspicious:</strong> {{ report.vt.last_analysis_stats.suspicious }}</p>
                <p><strong>Harmless:</strong> {{ report.vt.last_analysis_stats.harmless }}</p>
                <p><strong>ASN:</strong> {{ report.vt.asn }}</p>
                <p><strong>Owner:</strong> {{ report.vt.as_owner }}</p>
                <p><strong>Country:</strong> {{ report.vt.country }}</p>
                <p><strong>Tags:</strong> {{ report.vt.tags | join(', ') }}</p>
            </div>
        </div>
    </div>


<div class="col-md-6">
    <div class="card shadow-sm h-100">
        <div class="card-header bg-warning  text-dark fw-bold d-flex justify-content-between">
            <span>Proxychecker.io</span>
        </div>
        <div class="card-body">
            <div class="d-flex flex-wrap gap-2">
                {% if report.vpn.is_vpn %}
                    <span class="badge bg-danger">VPN DETECTED</span>
                {% endif %}

                {% if report.vpn.is_proxy %}
                    <span class="badge bg-danger">PROXY ACTIVE</span>
                {% endif %}

                {% if report.vpn.is_tor %}
                    <span class="badge bg-dark">TOR NODE</span>
                {% endif %}

                {% if report.vpn.is_compromised %}
                    <span class="badge bg-danger animate-pulse">COMPROMISED HOST</span>
                {% endif %}

                {% if report.vpn.is_scraper %}
                    <span class="badge bg-warning text-dark">WEB SCRAPER</span>
                {% endif %}

                {% if report.vpn.is_hosting %}
                    <span class="badge bg-dark text-white">DATACENTER / HOSTING</span>
                {% endif %}
                
                {% if not report.vpn.is_vpn and not report.vpn.is_proxy and not report.vpn.is_compromised %}
                    <span class="badge bg-success">NO ANONYMIZERS DETECTED</span>
                {% endif %}
                  <span class="badge 
                  {% if report.vpn.risk_score >= 75 %}
                       bg-danger
                  {% elif report.vpn.risk_score >= 35 %}
                      bg-warning text-dark
                  {% else %}
                      bg-success
                  {% endif %}">
    {{ report.vpn.risk_score }}% Risk
</span>
            </div>

            <hr>
            <p><strong>Confidence:</strong> {{ report.vpn.confidence }}%</p>
            
            {% if report.vpn.last_seen != "Never" %}
                <p><strong>Last Activity:</strong> {{ report.vpn.last_seen }}</p>
            {% endif %}
        </div>
    </div>
</div>



</div>
{% endif %}
</div>


<!-- Bootstrap JS (optional for interactive components) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
